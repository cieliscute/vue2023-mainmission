import{t as v,S as l,c as k}from"./myFunction-b1MJYAll.js";import{_ as S}from"./MixinComponent-o4EAp0kf.js";import{c as m,b as o,F as p,a as e,w as L,d as c,i as C,r as u,o as f,e as d,p as T,h as w}from"./index-WTnILUuV.js";import{_ as x}from"./_plugin-vue_export-helper-x3n3nnut.js";var B={VITE_APIURL:"https://vue3-course-api.hexschool.io/v2",VITE_API_ADMIN:"weiwei324",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APIURL:_}=B,I={data(){return{tokenChecked:!1,fullScreenLoadingStatus:!0}},components:{},methods:{checkToken(){this.fullScreenLoadingStatus=!0,delete this.$http.defaults.headers.common.Authorization;const t=v(),a=`${_}/api/user/check`;this.$http.post(a,null,{headers:{Authorization:t}}).then(()=>{this.$http.defaults.headers.common.Authorization=t,this.tokenChecked=!0,this.fullScreenLoadingStatus=!1,this.addToast({content:"登入驗證：成功"}),this.$router.push("/dashboard/manageproducts")}).catch(()=>{this.fullScreenLoadingStatus=!1,l.fire({title:"請正確登入再訪問後台頁面",text:"回到登入頁面",icon:"error",allowOutsideClick:!1,timer:3e3,timerProgressBar:!0,confirmButtonText:"OK"}).then(s=>{s.dismiss===l.DismissReason.timer&&this.$router.push("/adminlogin"),s.isConfirmed&&this.$router.push("/adminlogin")})})},logout(){l.fire({title:"確定要登出嗎？",icon:"question",allowOutsideClick:!1,showCancelButton:!0,buttonsStyling:!1,customClass:{confirmButton:"btn btn-danger",cancelButton:"btn btn-outline-secondary ms-3"},confirmButtonText:"確認",cancelButtonText:"取消"}).then(t=>{if(t.isConfirmed){this.fullScreenLoadingStatus=!0;const a=`${_}/logout`;return this.$http.post(a)}return Promise.reject(new Error("User cancelled"))}).then(()=>{this.fullScreenLoadingStatus=!1,k(),this.$router.push("/adminlogin")}).catch(t=>{this.fullScreenLoadingStatus=!1,t.message!=="User cancelled"&&this.addToast({content:"登出過程出現錯誤",style:"error"})})}},mounted(){this.checkToken()},mixins:[S]},V=t=>(T("data-v-36d41ac5"),t=t(),w(),t),R={class:"navbar bg-dark border-bottom border-body navbar-expand-sm","data-bs-theme":"dark"},$={class:"container-fluid"},y=V(()=>e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navcollapse","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),A={class:"collapse navbar-collapse",id:"navcollapse"},E={class:"navbar-nav me-auto my-1"},P={class:"nav-item"},D={class:"nav-item"},U={class:"nav-item"};function N(t,a,s,O,n,h){const g=u("FullScreenLoading"),r=u("RouterLink"),b=u("RouterView");return f(),m(p,null,[o(g,{active:n.fullScreenLoadingStatus,"onUpdate:active":a[0]||(a[0]=i=>n.fullScreenLoadingStatus=i),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),n.tokenChecked?(f(),m(p,{key:0},[e("nav",R,[e("div",$,[e("a",{class:"navbar-brand",href:"#",onClick:a[1]||(a[1]=L(()=>{},["prevent"]))},"後台頁面"),y,e("div",A,[e("ul",E,[e("li",P,[o(r,{class:"nav-link","aria-current":"page",to:"/dashboard/manageproducts"},{default:c(()=>[d("商品管理")]),_:1})]),e("li",D,[o(r,{class:"nav-link","aria-current":"page",to:"/dashboard/manageorders"},{default:c(()=>[d("訂單管理")]),_:1})]),e("li",U,[o(r,{class:"nav-link","aria-current":"page",to:"/home"},{default:c(()=>[d("返回前台頁面")]),_:1})])]),e("button",{class:"btn btn-outline-success me-0 me-sm-2",type:"button",onClick:a[2]||(a[2]=(...i)=>h.logout&&h.logout(...i))},"登出")])])]),o(b)],64)):C("",!0)],64)}const q=x(I,[["render",N],["__scopeId","data-v-36d41ac5"]]);export{q as default};
