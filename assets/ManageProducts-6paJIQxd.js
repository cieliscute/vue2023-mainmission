import{S as b,t as D}from"./myFunction-b1MJYAll.js";import{o as d,c,a as t,n as p,w as S,F as x,j as M,t as m,b as r,d as C,e as $,g,v as k,k as L,r as h}from"./index-WTnILUuV.js";import{_ as P}from"./_plugin-vue_export-helper-x3n3nnut.js";import{_ as T}from"./MixinComponent-o4EAp0kf.js";const U={props:["pages"],methods:{updatePage(l){this.$emit("emitPages",l)}}},B={"aria-label":"Page navigation example"},F={class:"pagination justify-content-center"},E=t("span",{"aria-hidden":"true"},"«",-1),A=[E],I={key:0,class:"page-link"},O=["onClick"],N=t("span",{"aria-hidden":"true"},"»",-1),q=[N];function R(l,e,a,_,s,i){return d(),c("nav",B,[t("ul",F,[t("li",{class:p([{disabled:!a.pages.has_pre},"page-item"])},[t("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=S(n=>i.updatePage(a.pages.current_page-1),["prevent"]))},A)],2),(d(!0),c(x,null,M(a.pages.total_pages,n=>(d(),c("li",{class:p(["page-item",{active:a.pages.current_page===n}]),key:n},[n===a.pages.current_page?(d(),c("span",I,m(n),1)):(d(),c("a",{key:1,class:"page-link",href:"#",onClick:S(f=>i.updatePage(n),["prevent"])},m(n),9,O))],2))),128)),t("li",{class:p(["page-item",{disabled:!a.pages.has_next}])},[t("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=S(n=>i.updatePage(a.pages.current_page+1),["prevent"]))},q)],2)])])}const z=P(U,[["render",R]]),K={props:["tempData","confirmFn"],data(){return{bsModal:"",productData:{}}},methods:{show(){this.bsModal.show()},hide(){this.bsModal.hide()},onSubmit(){this.confirmFn({data:this.productData})}},watch:{tempData(l){this.productData={...l.productData}}},mounted(){const l=this.$refs.productModal;this.bsModal=new this.$bs.Modal(l)}},j={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"productModalLabel","aria-hidden":"true"},G={class:"modal-dialog modal-xl"},H={class:"modal-content border-0"},J={class:"modal-header bg-dark text-white"},Q={id:"productModalLabel",class:"modal-title"},W=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),X={class:"modal-body"},Y={class:"row"},Z={class:"col-12 col-lg-4 mb-5 mb-lg-0"},tt={class:"mb-2"},et={class:"mb-3"},ot=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),st=t("img",{class:"img-fluid",src:"",alt:""},null,-1),at=t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")],-1),lt=t("div",null,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100"}," 刪除圖片 ")],-1),nt={class:"col-12 col-lg-8"},it={class:"mb-3"},dt=t("label",{for:"title",class:"form-label"},"標題",-1),ct={class:"row"},rt={class:"mb-3 col-md-6"},ut=t("label",{for:"category",class:"form-label"},"分類",-1),pt={class:"mb-3 col-md-6"},mt=t("label",{for:"price",class:"form-label"},"單位",-1),ht={class:"row"},_t={class:"mb-3 col-md-6"},ft=t("label",{for:"origin_price",class:"form-label"},"原價",-1),bt={class:"mb-3 col-md-6"},gt=t("label",{for:"price",class:"form-label"},"售價",-1),vt=t("hr",null,null,-1),yt={class:"mb-3"},St=t("label",{for:"description",class:"form-label"},"產品描述",-1),kt={class:"mb-3"},xt=t("label",{for:"content",class:"form-label"},"說明內容",-1),Pt={class:"mb-3"},Dt={class:"form-check"},Mt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Vt=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),t("button",{type:"submit",class:"btn btn-primary"}," 確認 ")],-1);function wt(l,e,a,_,s,i){const n=h("VField"),f=h("VForm");return d(),c("div",j,[t("div",G,[r(f,{onSubmit:i.onSubmit},{default:C(({errors:u})=>[t("div",H,[t("div",J,[t("h5",Q,[t("span",null,m(a.tempData.modalTitle)+"產品",1)]),W]),t("div",X,[$(m(u)+" ",1),t("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[ot,g(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=o=>s.productData.imageUrl=o)},null,512),[[k,s.productData.imageUrl]])]),st]),at,lt]),t("div",nt,[t("div",it,[dt,r(n,{id:"title",type:"text",class:p(["form-control",{"is-invalid":u.title}]),placeholder:"請輸入標題",modelValue:s.productData.title,"onUpdate:modelValue":e[1]||(e[1]=o=>s.productData.title=o),rules:"required",name:"title"},null,8,["modelValue","class"])]),t("div",ct,[t("div",rt,[ut,r(n,{id:"category",type:"text",class:p(["form-control",{"is-invalid":u.category}]),placeholder:"請輸入分類",modelValue:s.productData.category,"onUpdate:modelValue":e[2]||(e[2]=o=>s.productData.category=o),rules:"required",name:"category"},null,8,["modelValue","class"])]),t("div",pt,[mt,r(n,{id:"unit",type:"text",class:p(["form-control",{"is-invalid":u.unit}]),placeholder:"請輸入單位",modelValue:s.productData.unit,"onUpdate:modelValue":e[3]||(e[3]=o=>s.productData.unit=o),rules:"required",name:"unit"},null,8,["modelValue","class"])])]),t("div",ht,[t("div",_t,[ft,r(n,{id:"origin_price",type:"number",min:"0",class:p(["form-control",{"is-invalid":u.origin_price}]),placeholder:"請輸入原價",modelValue:s.productData.origin_price,"onUpdate:modelValue":e[4]||(e[4]=o=>s.productData.origin_price=o),modelModifiers:{number:!0},rules:"required",name:"origin_price"},null,8,["modelValue","class"])]),t("div",bt,[gt,r(n,{id:"price",type:"number",min:"0",class:p(["form-control",{"is-invalid":u.price}]),placeholder:"請輸入售價",modelValue:s.productData.price,"onUpdate:modelValue":e[5]||(e[5]=o=>s.productData.price=o),modelModifiers:{number:!0},rules:"required",name:"price"},null,8,["modelValue","class"])])]),vt,t("div",yt,[St,g(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[6]||(e[6]=o=>s.productData.description=o)},`
                  `,512),[[k,s.productData.description]])]),t("div",kt,[xt,g(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[7]||(e[7]=o=>s.productData.content=o)},`
                  `,512),[[k,s.productData.content]])]),t("div",Pt,[t("div",Dt,[g(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[8]||(e[8]=o=>s.productData.is_enabled=o)},null,512),[[L,s.productData.is_enabled]]),Mt])])])])]),Vt])]),_:1},8,["onSubmit"])])],512)}const Ct=P(K,[["render",wt]]);var $t={VITE_APIURL:"https://vue3-course-api.hexschool.io/v2",VITE_API_ADMIN:"weiwei324",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APIURL:v,VITE_API_ADMIN:y}=$t,Lt={data(){return{fullScreenLoadingStatus:!0,products:"",tempData:"",confirmFn:"",pagination:""}},computed:{},methods:{getProducts(l=1){this.fullScreenLoadingStatus=!0;const e=`${v}/api/${y}/admin/products?page=${l}`;this.$http.get(e).then(a=>{this.products=a.data.products,this.pagination=a.data.pagination,this.fullScreenLoadingStatus=!1}).catch(()=>{b.fire({title:"取得資料發生錯誤",icon:"error",allowOutsideClick:!1,timer:3e3,timerProgressBar:!0,confirmButtonText:"OK"})})},openModal(){this.$refs.editModal.show()},hideModal(){this.$refs.editModal.hide()},putProduct(l){const e=D();this.tempData={modalTitle:"編輯",productData:l},this.confirmFn=a=>{this.fullScreenLoadingStatus=!0;const _=`${v}/api/${y}/admin/product/${l.id}`;this.$http.put(_,a,{headers:{Authorization:e}}).then(()=>{this.fullScreenLoadingStatus=!1,this.hideModal(),this.addToast({content:"產品更新成功"}),this.getProducts()}).catch(()=>{this.fullScreenLoadingStatus=!1,this.hideModal(),b.fire({title:"發生一點錯誤",text:"資料沒有上傳完成，請再試一次。如果持續發生相同問題請聯繫管理員",icon:"error",allowOutsideClick:!1,timer:3e3,timerProgressBar:!0,confirmButtonText:"OK"})})},this.openModal()},postProduct(){const l=D();this.tempData={modalTitle:"新增",productData:{}},this.confirmFn=e=>{this.fullScreenLoadingStatus=!0;const a=`${v}/api/${y}/admin/product`;this.$http.post(a,e,{headers:{Authorization:l}}).then(()=>{this.fullScreenLoadingStatus=!1,this.hideModal(),this.addToast({content:"產品更新成功"}),this.getProducts()}).catch(()=>{this.fullScreenLoadingStatus=!1,this.hideModal(),b.fire({title:"發生一點錯誤",text:"資料沒有上傳完成，請再試一次。如果持續發生相同問題請聯繫管理員",icon:"error",allowOutsideClick:!1,timer:3e3,timerProgressBar:!0,confirmButtonText:"OK"})})},this.openModal()},deleteProduct(l){const e=`${v}/api/${y}/admin/product/${l.id}`;b.fire({title:"確認刪除？",text:`你確定要刪除品項：${l.title} 嗎？`,icon:"warning",allowOutsideClick:!1,showCancelButton:!0,buttonsStyling:!1,customClass:{confirmButton:"btn btn-danger",cancelButton:"btn btn-outline-secondary ms-3"},confirmButtonText:"確認刪除",cancelButtonText:"取消操作"}).then(a=>{a.isConfirmed&&(this.fullScreenLoadingStatus=!0,this.$http.delete(e).then(()=>{this.fullScreenLoadingStatus=!1,this.addToast({content:"成功刪除品項"}),this.getProducts()}).catch(()=>{this.fullScreenLoadingStatus=!1,this.addToast({content:"刪除品項過程出現錯誤,請重新整理後再次操作",style:"error"})}))})}},components:{ProductEditModal:Ct,PaginationComponent:z},mounted(){this.getProducts()},mixins:[T]},Tt={class:"container-fluid"},Ut={class:"text-end mt-4"},Bt={class:"table mt-4"},Ft=t("thead",null,[t("tr",null,[t("th",{width:"120"}," 分類 "),t("th",null,"產品名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"100"}," 是否啟用 "),t("th",{width:"120"}," 編輯 ")])],-1),Et={class:"text-end"},At={class:"text-end"},It={class:"text-end"},Ot={key:0,class:"text-mute"},Nt={key:1,class:"text-success"},qt={class:"btn-group"},Rt=["onClick"],zt=["onClick"];function Kt(l,e,a,_,s,i){const n=h("FullScreenLoading"),f=h("ProductEditModal"),u=h("PaginationComponent");return d(),c(x,null,[r(n,{active:s.fullScreenLoadingStatus,"onUpdate:active":e[0]||(e[0]=o=>s.fullScreenLoadingStatus=o),"can-cancel":!1,color:"#FAA",loader:"dots","is-full-page":!0},null,8,["active"]),r(f,{ref:"editModal","temp-data":s.tempData,"confirm-fn":s.confirmFn},null,8,["temp-data","confirm-fn"]),t("div",Tt,[t("div",Ut,[t("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=(...o)=>i.postProduct&&i.postProduct(...o))}," 建立新的產品 ")]),t("table",Bt,[Ft,t("tbody",null,[(d(!0),c(x,null,M(s.products,(o,V)=>(d(),c("tr",{key:`${V}-list`},[t("td",null,m(o.category),1),t("td",null,m(o.title),1),t("td",Et,m(o.origin_price),1),t("td",At,m(o.price),1),t("td",It,[o.is_enabled===0?(d(),c("span",Ot,"未啟用")):(d(),c("span",Nt,"啟用"))]),t("td",null,[t("div",qt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:w=>i.putProduct(o)}," 編輯 ",8,Rt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:w=>i.deleteProduct(o)}," 刪除 ",8,zt)])])]))),128))])]),r(u,{pages:s.pagination,onEmitPages:i.getProducts},null,8,["pages","onEmitPages"])])],64)}const Qt=P(Lt,[["render",Kt]]);export{Qt as default};
