import{t as k,S as i,c as v}from"./myFunction-P3p7yGm4.js";import{_ as S}from"./MixinComponent-A9zCkWDO.js";import{c as u,b as o,F as h,a,w as L,d as m,i as C,r as l,o as p,e as f,p as T,h as w}from"./index-nBUGE8VV.js";import{_ as x}from"./_plugin-vue_export-helper-x3n3nnut.js";var B={VITE_APIURL:"https://vue3-course-api.hexschool.io/v2",VITE_API_ADMIN:"weiwei324",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APIURL:g}=B,I={data(){return{tokenChecked:!1,fullScreenLoadingStatus:!0}},components:{},methods:{checkToken(){this.fullScreenLoadingStatus=!0,delete this.$http.defaults.headers.common.Authorization;const t=k(),e=`${g}/api/user/check`;this.$http.post(e,null,{headers:{Authorization:t}}).then(()=>{this.$http.defaults.headers.common.Authorization=t,this.tokenChecked=!0,this.fullScreenLoadingStatus=!1,this.addToast({content:"登入驗證：成功"}),this.$router.push("/dashboard/manageproducts")}).catch(()=>{this.fullScreenLoadingStatus=!1,i.fire({title:"請正確登入再訪問後台頁面",text:"回到登入頁面",icon:"error",allowOutsideClick:!1,timer:3e3,timerProgressBar:!0,confirmButtonText:"OK"}).then(s=>{s.dismiss===i.DismissReason.timer&&this.$router.push("/adminlogin"),s.isConfirmed&&this.$router.push("/adminlogin")})})},logout(){i.fire({title:"確定要登出嗎？",icon:"question",allowOutsideClick:!1,showCancelButton:!0,buttonsStyling:!1,customClass:{confirmButton:"btn btn-danger",cancelButton:"btn btn-outline-secondary ms-3"},confirmButtonText:"確認",cancelButtonText:"取消"}).then(t=>{if(t.isConfirmed){this.fullScreenLoadingStatus=!0;const e=`${g}/logout`;return this.$http.post(e)}return Promise.reject(new Error("User cancelled"))}).then(()=>{this.fullScreenLoadingStatus=!1,v(),this.$router.push("/adminlogin")}).catch(t=>{this.fullScreenLoadingStatus=!1,t.message!=="User cancelled"&&this.addToast({content:"登出過程出現錯誤",style:"error"})})}},mounted(){this.checkToken()},mixins:[S]},V=t=>(T("data-v-0c4dd5a4"),t=t(),w(),t),R={class:"navbar bg-dark border-bottom border-body navbar-expand-sm","data-bs-theme":"dark"},$={class:"container-fluid"},y=V(()=>a("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navcollapse","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[a("span",{class:"navbar-toggler-icon"})],-1)),A={class:"collapse navbar-collapse",id:"navcollapse"},E={class:"navbar-nav me-auto my-1"},P={class:"nav-item"},D={class:"nav-item"};function U(t,e,s,N,n,c){const _=l("FullScreenLoading"),d=l("RouterLink"),b=l("RouterView");return p(),u(h,null,[o(_,{active:n.fullScreenLoadingStatus,"onUpdate:active":e[0]||(e[0]=r=>n.fullScreenLoadingStatus=r),"can-cancel":!1,"is-full-page":!0},null,8,["active"]),n.tokenChecked?(p(),u(h,{key:0},[a("nav",R,[a("div",$,[a("a",{class:"navbar-brand",href:"#",onClick:e[1]||(e[1]=L(()=>{},["prevent"]))},"後台頁面"),y,a("div",A,[a("ul",E,[a("li",P,[o(d,{class:"nav-link","aria-current":"page",to:"/dashboard/manageproducts"},{default:m(()=>[f("商品管理")]),_:1})]),a("li",D,[o(d,{class:"nav-link","aria-current":"page",to:"/dashboard/manageorders"},{default:m(()=>[f("訂單管理")]),_:1})])]),a("button",{class:"btn btn-outline-success me-0 me-sm-2",type:"button",onClick:e[2]||(e[2]=(...r)=>c.logout&&c.logout(...r))},"登出")])])]),o(b)],64)):C("",!0)],64)}const j=x(I,[["render",U],["__scopeId","data-v-0c4dd5a4"]]);export{j as default};
